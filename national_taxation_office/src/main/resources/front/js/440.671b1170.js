"use strict";(self["webpackChunkfront"]=self["webpackChunkfront"]||[]).push([[440],{5440:function(e,l,a){a.r(l),a.d(l,{default:function(){return b}});var t=a(3396),o=a(9242);const u={slot:"footer",class:"dialog-footer"};function n(e,l,a,n,i,r){const d=(0,t.up)("el-button"),s=(0,t.up)("el-input"),c=(0,t.up)("el-col"),m=(0,t.up)("el-row"),p=(0,t.up)("el-card"),g=(0,t.up)("el-table-column"),v=(0,t.up)("el-table"),h=(0,t.up)("el-scrollbar"),f=(0,t.up)("el-form-item"),w=(0,t.up)("el-radio"),C=(0,t.up)("el-radio-group"),R=(0,t.up)("el-form"),b=(0,t.up)("el-dialog"),k=(0,t.up)("el-pagination");return(0,t.wg)(),(0,t.iD)("div",null,[(0,t.Wm)(p,null,{default:(0,t.w5)((()=>[(0,t.Wm)(m,{gutter:20},{default:(0,t.w5)((()=>[(0,t.Wm)(c,{span:8},{default:(0,t.w5)((()=>[(0,t.Wm)(s,{placeholder:"请输入内容",modelValue:n.searchText,"onUpdate:modelValue":l[0]||(l[0]=e=>n.searchText=e),modelModifiers:{trim:!0,lazy:!0},onKeyup:(0,o.D2)(n.searchTableData,["enter"])},{append:(0,t.w5)((()=>[(0,t.Wm)(d,{class:"el-icon-search",onClick:n.searchTableData},null,8,["onClick"])])),_:1},8,["modelValue","onKeyup"])])),_:1}),(0,t.Wm)(c,{span:4},{default:(0,t.w5)((()=>[(0,t.Wm)(d,{type:"primary",onClick:n.openAddRoleDialog},{default:(0,t.w5)((()=>[(0,t.Uk)("添加角色")])),_:1},8,["onClick"])])),_:1}),(0,t.Wm)(c,{span:4},{default:(0,t.w5)((()=>[(0,t.Wm)(d,{type:"danger",onClick:n.multipleDelete},{default:(0,t.w5)((()=>[(0,t.Uk)("批量删除")])),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1}),(0,t.Wm)(h,null,{default:(0,t.w5)((()=>[(0,t.Wm)(v,{data:n.paginatedTableData,ref:"multipleTableRef",onSelectionChange:n.handleSelectionChange},{default:(0,t.w5)((()=>[(0,t.Wm)(g,{type:"selection",width:"55"}),(0,t.Wm)(g,{prop:"roleName",label:"角色名称",span:"4"}),(0,t.Wm)(g,{label:"操作"},{default:(0,t.w5)((e=>[(0,t.Wm)(d,{type:"primary",onClick:l=>n.editRole(e.row)},{default:(0,t.w5)((()=>[(0,t.Uk)("编辑")])),_:2},1032,["onClick"]),(0,t.Wm)(d,{type:"danger",onClick:l=>n.deleteRole(e.row)},{default:(0,t.w5)((()=>[(0,t.Uk)("删除")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data","onSelectionChange"])])),_:1}),(0,t.Wm)(b,{modelValue:n.showAddRoleDialog,"onUpdate:modelValue":l[4]||(l[4]=e=>n.showAddRoleDialog=e),title:"添加/编辑用户",onClose:n.resetEditingRole},{default:(0,t.w5)((()=>[(0,t.Wm)(R,{model:n.editingRole,"label-width":"100px",rules:n.formRules},{default:(0,t.w5)((()=>[(0,t.Wm)(f,{label:"角色名称"},{default:(0,t.w5)((()=>[(0,t.Wm)(s,{modelValue:n.editingRole.roleName,"onUpdate:modelValue":l[1]||(l[1]=e=>n.editingRole.roleName=e),disabled:n.editingRole.editing},null,8,["modelValue","disabled"])])),_:1}),(0,t.Wm)(f,{label:"权限"},{default:(0,t.w5)((()=>["addRoleOperation"===n.editingRole.operation?((0,t.wg)(),(0,t.j4)(C,{key:0,modelValue:n.editingRole.authority,"onUpdate:modelValue":l[2]||(l[2]=e=>n.editingRole.authority=e)},{default:(0,t.w5)((()=>[(0,t.Wm)(w,{label:1},{default:(0,t.w5)((()=>[(0,t.Uk)("个人空间")])),_:1}),(0,t.Wm)(w,{label:2},{default:(0,t.w5)((()=>[(0,t.Uk)("纳税服务")])),_:1})])),_:1},8,["modelValue"])):"editRoleOperation"===n.editingRole.operation?((0,t.wg)(),(0,t.j4)(C,{key:1,modelValue:n.editingRole.authority,"onUpdate:modelValue":l[3]||(l[3]=e=>n.editingRole.authority=e)},{default:(0,t.w5)((()=>[(0,t.Wm)(w,{label:1},{default:(0,t.w5)((()=>[(0,t.Uk)("权限1")])),_:1}),(0,t.Wm)(w,{label:2},{default:(0,t.w5)((()=>[(0,t.Uk)("权限2")])),_:1}),(0,t.Wm)(w,{label:3},{default:(0,t.w5)((()=>[(0,t.Uk)("权限3")])),_:1}),(0,t.Wm)(w,{label:4},{default:(0,t.w5)((()=>[(0,t.Uk)("权限4")])),_:1})])),_:1},8,["modelValue"])):(0,t.kq)("",!0)])),_:1})])),_:1},8,["model","rules"]),(0,t._)("div",u,[(0,t.Wm)(d,{onClick:n.cancelAddRole},{default:(0,t.w5)((()=>[(0,t.Uk)("取消")])),_:1},8,["onClick"]),(0,t.Wm)(d,{type:"primary",onClick:n.saveRole},{default:(0,t.w5)((()=>[(0,t.Uk)("保存")])),_:1},8,["onClick"])])])),_:1},8,["modelValue","onClose"]),(0,t.Wm)(k,{onSizeChange:n.handlePageSizeChange,onCurrentChange:n.handleCurrentPageChange,"current-page":n.currentPage,"page-sizes":[10,20,30,50],"page-size":n.pageSize,total:n.filteredTableData.length,layout:"sizes, prev, pager, next, jumper",class:"pagination-centered"},null,8,["onSizeChange","onCurrentChange","current-page","page-size","total"])])}a(7658);var i=a(4870),r=a(4161),d=a(491),s=a(4550),c=a(7947),m=a(6e3),p=a(1955),g=a(3417),v=a(2261),h=a(7178),f=a(3191),w={components:{ElTable:s.eI,ElDialog:c.d0,ElMessageBox:m.T,ElForm:p.ly,ElFormItem:p.nH,ElInput:g.EZ,ElButton:v.ElButton,ElMessage:h.z8,ElPagination:f.R},setup(){const e=80,l=(0,i.iH)(""),a=(0,i.iH)([]),o=(0,i.iH)([]),u=(0,i.iH)([]),n=(0,i.iH)(!1),s=(0,i.iH)({}),c=(0,i.iH)(),p=(0,i.iH)([]),g=(0,i.iH)(1),v=(0,i.iH)(5),f=(0,i.iH)(0),w={roleName:[{required:!0,message:"角色名称不能为空",trigger:"blur"}]},C=async()=>{try{const e=await d.Z.fetchTableData();a.value=e,u.value=[...e],o.value=a}catch(e){}};(0,t.bv)((()=>{C()}));const R=()=>{if(g.value=1,p.value=[],l.value){const e=l.value.trim().toLowerCase(),t=a.value.filter((l=>l.roleName.toLowerCase().includes(e)));0===t.length?m.T.alert("查询失败","提示",{type:"error"}):(o.value=t,f.value=Math.ceil(t.length/v.value))}else o.value=a.value},b=async()=>{if(p.value.length>0)try{const l=p.value,t=l.map((e=>e.roleId));console.log(t),await r.Z.delete(`http://localhost:${e}/roles/batch`,{data:t}),a.value=a.value.filter((e=>!l.includes(e))),p.value=[],h.z8.success("批量删除成功")}catch(l){console.error("Error deleting roles:",l)}else h.z8.warning("请先选择要删除的数据")},k=e=>{n.value=!0,s.value={...e,editing:!0,operation:"editRoleOperation"}},y=async l=>{const t=l.roleId;console.log(t),console.log(l);try{await r.Z.delete(`http://localhost:${e}/roles/delete/${t}`),a.value=a.value.filter((e=>e.roleId!==t)),o.value=o.value.filter((e=>e.roleId!==t))}catch(u){console.error("Error deleting role:",u)}},W=()=>{n.value=!0,s.value={editing:!1,operation:"addRoleOperation"}},_=()=>{n.value=!1,s.value={}},D=async()=>{if(s.value.roleName&&s.value.authority){s.value.state=Number(s.value.authority);const l=a.value.find((e=>e.roleName===s.value.roleName&&e.state===s.value.state));if(l)return void h.z8.warning("已经给该角色赋予过该权限了");if(s.value.editing){const l={roleId:s.value.roleId,roleName:s.value.roleName,state:s.value.state},t=(await r.Z.put(`http://localhost:${e}/roles/update/${s.value.roleId}`,l),a.value.findIndex((e=>e.roleName===s.value.roleName)));-1!==t&&(a.value[t]={...s.value,editing:!1})}else{const l={roleId:s.value.roleId,roleName:s.value.roleName,state:s.value.state};await r.Z.post(`http://localhost:${e}/roles/addRole`,l);a.value.push({...s.value})}n.value=!1,s.value={}}else h.z8.warning("请填写必要信息")},U=()=>{s.value={}},z=e=>{p.value=e},T=(0,t.Fl)((()=>{const e=(g.value-1)*v.value,l=e+v.value;return f.value=Math.ceil(o.value.length/v.value),o.value.slice(e,l)})),E=e=>{v.value=e,g.value=1},N=e=>{const l=Math.ceil(o.value.length/v.value);g.value=Math.max(1,Math.min(e,l))};return(0,t.YP)(a,(e=>{o.value=e})),{searchText:l,tableData:a,showAddRoleDialog:n,editingRole:s,multipleTableRef:c,multipleSelection:p,currentPage:g,pageSize:v,totalPages:f,filteredTableData:o,formRules:w,searchTableData:R,multipleDelete:b,editRole:k,deleteRole:y,openAddRoleDialog:W,cancelAddRole:_,saveRole:D,resetEditingRole:U,handleSelectionChange:z,paginatedTableData:T,handlePageSizeChange:E,handleCurrentPageChange:N}}},C=a(89);const R=(0,C.Z)(w,[["render",n]]);var b=R}}]);
//# sourceMappingURL=440.671b1170.js.map